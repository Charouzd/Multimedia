<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <link rel="icon" type="image/png" href="media/img/logo.png">
        <title>PONIG PONG</title>
        <script src="https://kit.fontawesome.com/4e7b80b1e6.js" crossorigin="anonymous"></script>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
    </head>
    <body>
        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/js/bootstrap.min.js"></script>

        <main style="min-height:100vh;width:100%;display:flex;justify-content:center;align-items:center;flex-direction:column">
            <h1 style="text-decoration:underline;margin:1rem">Multimedia 2025/26 ->PONIG PONG</h1>
            
            <form style="width:75%; margin: 2rem" id='userForm'>
                <div style="margin: 2rem 0;" class="form-group">
                    <div style="display: flex;"><label style="margin-right: 3rem;" for="AI"><h3>Hra proti AI</h3></label>
                    <input style="width: 2rem;" class="form-control" type="checkbox" id="AI" name="AI"></div>
                    <label><h3>Schopnosti AI protivníka</h3></label>
                    <div style="display: flex;"><h6>Lenochod</h6> <input style="margin: 0 2rem;" type="range" name="AIspeed" step="0.001" value="0.05" min="0.009"  max="0.09" class="form-control-range" id="AIspeed"> <h6>Neporazitelný král pongu</h6></div>
                </div>
                <div class="form-group">
                    <label for="cap"><h3>Na kolik vítězných bodů se bude hrát</h3></label>
                    <div style="display: flex; justify-content:center;align-items:baseline"><h6>1</h6> <input style="margin: 0 2rem;" type="range" class="form-control-range" id="cap" name="cap" min="1" max="13" step="1" value="13"> <h6>13</h6></div>
                </div>

                <div class="form-group">
                    <label><h3>Pálka Hráče č.1</h3></label>
                    <select id="P1" name="P1" class="form-control" data-default="fire"></select>
                </div>
                <div class="form-group">
                    <label><h3>Pálka Hráče č.2</h3></label>
                    <select id="P2" name="P2" class="form-control" data-default="ice"></select>
                </div>
                <div class="form-group">
                    <label><h3>Míček</h3></label>
                    <select id="Ball" name="Ball" class="form-control" data-default="melone"></select>
                </div>

                <p>
                    <input class="btn btn-primary mb-2" type="submit" name="submit" id="sub" value="Začít hrát">
                    <button class="btn btn-warning mb-2" type="button" data-toggle="collapse" data-target="#collapseWidthExample">Ovládání</button>
                </p>
            </form>

            <div style="min-height: 120px; width: 33%;">
                <div class="collapse" style="width: 100%;" id="collapseWidthExample">
                  <div class="card card-body" style="width: 100%; text-align:center" >
                    <span class="text-success" >Hráč 1(zelený)</span> -> Levá strana<br>
                    <span class="text-danger">Hráč 2(červený)</span> -> Pravá strana<br>
                    <h4>Ovládání:</h4>
                    </div>
                </div>
            </div>

            <script>
    // Funkce pro generování <option> (stejná jako předtím)
    function generujMoznosti(elementId, seznam, defaultVal) {
        const select = document.getElementById(elementId);
        select.innerHTML = ""; // Vyčistit pro jistotu

        seznam.forEach(soubor => {
            const jmeno = soubor.split('.')[0]; 
            const option = document.createElement("option");
            option.value = "media/img/" + soubor;
            option.text = jmeno.charAt(0).toUpperCase() + jmeno.slice(1);
            
            if (jmeno === defaultVal) {
                option.selected = true;
            }
            select.appendChild(option);
        });
    }

    // --- ZDE JE TA ZMĚNA: NAČTENÍ SOUBORU ---
    fetch('sources.txt')
        .then(response => {
            if (!response.ok) {
                throw new Error("Nepodařilo se načíst sources.txt");
            }
            return response.text();
        })
        .then(text => {
            // Tvůj text vypadá takto: "a.jpg","b.jpg"
            // Aby to bylo pole, musíme to obalit hranatými závorkami []
            // a převést z textu na skutečné JavaScript pole pomocí JSON.parse
            const validniJson = '[' + text + ']'; 
            const seznamObrazku = JSON.parse(validniJson);
            

            // Teď když máme data, naplníme selecty
            generujMoznosti("P1", seznamObrazku, "fire");
            generujMoznosti("P2", seznamObrazku, "ice");
            generujMoznosti("Ball", seznamObrazku, "melone");
        })
        .catch(error => {
            console.error("Chyba:", error);
            alert("Pozor: Prohlížeč zablokoval načtení sources.txt. Spusť stránku přes lokální server nebo zkontroluj název souboru.");
        });

    // Obsluha odeslání formuláře
    document.getElementById('userForm').addEventListener('submit', function(event) {
        event.preventDefault(); 
        const formData = new FormData(document.getElementById('userForm'));
        const queryString = new URLSearchParams(formData).toString();
        window.location.href = `game.html?${queryString}`;
    });
</script>
        </main>
    </body>
</html>